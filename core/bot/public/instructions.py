from aiogram.types import Message, InlineKeyboardButton
from core.functions.geocoder import geocoder
from core.bot.public.keyboards import (
    input_animals_buttons,
    send_button,
    input_media_files_button,
    # back_to_menu_button,
    # next_input_animals_button,
    next_button,
    menu_buttons,
    get_appeals_buttons,
    # back_to_animals_button,
    # back_to_count_animals_button,
    back_button
)
from core.database.operations import DataBase
import re

db = DataBase()


async def text_welcome(message: Message) -> str:

    text = f"<b>{message.chat.first_name}</b>, –¥–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –±–æ—Ç–∞!\n\n" \
           f"–ó–¥–µ—Å—å –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É –Ω–∞ —Å–ª—É—á–∞–∏ –∂–µ—Å—Ç–æ–∫–æ–≥–æ –æ–±—Ä–∞—â–µ–Ω–∏—è —Å –∂–∏–≤–æ—Ç–Ω—ã–º–∏ –≤ –≥–æ—Ä–æ–¥–µ. " \
           f"–ò–Ω—Å–ø–µ–∫—Ç–æ—Ä—ã –î–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–∞ –ø—Ä–∏—Ä–æ–¥–æ–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏ –æ—Ö—Ä–∞–Ω—ã –æ–∫—Ä—É–∂–∞—é—â–µ–π —Å—Ä–µ–¥—ã " \
           f"–ú–æ—Å–∫–≤—ã –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ –æ—Ç—Ä–∞–±–æ—Ç–∞—é—Ç —Å–∏—Ç—É–∞—Ü–∏—é –∏ –¥–∞–¥—É—Ç –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å.\n\n" \
           f"–£–∫–∞–∂–∏—Ç–µ —Ç–æ—á–Ω—ã–π –∞–¥—Ä–µ—Å –Ω–∏–∂–µ –∏–ª–∏ –æ—Å—Ç–∞–≤—å—Ç–µ –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é:"

    return text


async def text_help() -> str:

    text = f"–ó–¥–µ—Å—å –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É –Ω–∞ —Å–ª—É—á–∞–∏ –∂–µ—Å—Ç–æ–∫–æ–≥–æ –æ–±—Ä–∞—â–µ–Ω–∏—è —Å –∂–∏–≤–æ—Ç–Ω—ã–º–∏ –≤ –≥–æ—Ä–æ–¥–µ.\n\n" \
           f"–î–ª—è —ç—Ç–æ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–∫–∞–∑–∞—Ç—å –∞–¥—Ä–µ—Å –∏–ª–∏ –æ—Å—Ç–∞–≤–∏—Ç—å –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é, " \
           f"–≥–¥–µ –±—ã–ª –∑–∞–º–µ—á–µ–Ω –¥–∞–Ω–Ω—ã–π —Å–ª—É—á–∞–π, –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–º–µ—á–µ–Ω–Ω—ã—Ö –∂–∏–≤–æ—Ç–Ω—ã—Ö –∏ " \
           f"–ø–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–æ—Ç–æ/–≤–∏–¥–µ–æ –º–∞—Ç–µ—Ä–∏–∞–ª—ã.\n\n" \
           f"–ö–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω –ø—Ä–æ—Ü–µ—Å—Å: –ø–æ–ª—É—á–∏–≤ –æ–±—Ä–∞—â–µ–Ω–∏–µ, –¥–µ–∂—É—Ä–Ω—ã–π –∏–Ω—Å–ø–µ–∫—Ç–æ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é " \
           f"—á–µ—Ä–µ–∑ –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ –≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏—è, –≤—ã–∑—ã–≤–∞–µ—Ç –Ω–∞—Ä—è–¥ –ø–æ–ª–∏—Ü–∏–∏ –∏ –±–ª–∏–∂–∞–π—à–µ–≥–æ –∫ " \
           f"–∞–¥—Ä–µ—Å—É –∏–Ω—Å–ø–µ–∫—Ç–æ—Ä–∞. –ï—Å–ª–∏ –Ω–∞ –∂–∏–≤–æ—Ç–Ω–æ–µ –Ω–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, –æ–Ω–æ –±—É–¥–µ—Ç –∏–∑—ä—è—Ç–æ —É –Ω–∞—Ä—É—à–∏—Ç–µ–ª—è –∏ " \
           f"–æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ –¶–µ–Ω—Ç—Ä —Ä–µ–∞–±–∏–ª–∏—Ç–∞—Ü–∏–∏ –¥–∏–∫–∏—Ö –∂–∏–≤–æ—Ç–Ω—ã—Ö, –∞ –Ω–∞—Ä—É—à–∏—Ç–µ–ª—å –∑–∞–¥–µ—Ä–∂–∞–Ω.\n\n" \
           f"–†–∞–±–æ—Ç—ã –ø–æ —Å–ø–∞—Å–µ–Ω–∏—é –Ω–µ–∑–∞–∫–æ–Ω–Ω–æ —ç–∫—Å–ø–ª—É–∞—Ç–∏—Ä—É–µ–º—ã—Ö –∂–∏–≤–æ—Ç–Ω—ã—Ö –≤–µ–¥—É—Ç—Å—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ, " \
           f"–¥–µ–π—Å—Ç–≤—É–µ—Ç –≥–æ—Ä—è—á–∞—è –ª–∏–Ω–∏—è: <b>+7 (495) 777-77-77.</b>\n" \
           f"–ß–∞—â–µ –≤—Å–µ–≥–æ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ—ã –æ–±–∏–∂–∞—é—Ç —Å–æ–≤. –í –ø—Ä–æ—à–ª–æ–º –≥–æ–¥—É —Å–ø–∞—Å–ª–∏ 37 —ç—Ç–∏—Ö –ø—Ç–∏—Ü. –ê –≤–æ—Ç —Å–≤–µ–∂–∏–π " \
           f"<a href='https://ria.ru/20230208/sova-1850651469.html'>–ø—Ä–∏–º–µ—Ä</a>.\n\n" \
           f"–≠—Ç–æ—Ç –±–æ—Ç –ø–æ–∑–≤–æ–ª–∏—Ç –≤—ã—è–≤–ª—è—Ç—å —Å–ª—É—á–∞–∏ –Ω–∞—Ä—É—à–µ–Ω–∏—è –µ—â—ë –±—ã—Å—Ç—Ä–µ–µ.\n\n" \
           f"–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å —Å–≤–æ–∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã.\n\n" \
           f"<b><u>–í –±–æ—Ç–µ –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–æ–º–∞–Ω–¥:</u></b>\n" \
           f"/help - –ø–æ–º–æ—â—å\n" \
           f"/status - —Å—Ç–∞—Ç—É—Å –æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö –æ–±—Ä–∞—â–µ–Ω–∏–π\n" \
           f"/new - –Ω–æ–≤–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ"

    return text


async def text_status(telegram_id, appeal_id=None):
    status = {'sent': '–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ', None: '–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ', 'work': '–í —Ä–∞–±–æ—Ç–µ', 'done': '–û—Ç—Ä–∞–±–æ—Ç–∞–Ω–æ', 'reject': '–û—Ç–∫–ª–æ–Ω–µ–Ω–æ'}
    if appeal_id:
        appeal = await db.get_appeal_data(appeal_id, ['appeal_id', 'address', 'count_animal', 'animal', 'status', 'answer'])
        address = await geocoder(appeal.address)
        text = f"<b><u>–û–±—Ä–∞—â–µ–Ω–∏–µ ‚Ññ{appeal.appeal_id}</u></b>\n\n" \
               f"–£–∫–∞–∑–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:\n" \
               f"–ê–¥—Ä–µ—Å: <b>{address}</b>\n" \
               f"–í–∏–¥ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ: <b>{appeal.animal}</b>\n" \
               f"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∂–∏–≤–æ—Ç–Ω—ã—Ö: <b>{appeal.count_animal}</b>"

        if appeal.contact:
            text += f'\n–ö–æ–Ω—Ç–∞–∫—Ç—ã –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏: <b>{appeal.contact}</b>'
        text += f"\n\n–°—Ç–∞—Ç—É—Å: <b>{status.get(appeal.status)}</b>"
        if appeal.answer:
            text += f'\n–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: {appeal.answer}'

        return text
    else:
        appeal_ids = await db.get_appeal_ids(telegram_id)
        if appeal_ids:
            appeal = await db.get_appeal_data(appeal_ids[0], ['appeal_id', 'address', 'count_animal', 'animal', 'status', 'answer'])
            address = await geocoder(appeal.address)
            reply_markup = await get_appeals_buttons(appeal_ids)
            text = f"<b><u>–û–±—Ä–∞—â–µ–Ω–∏–µ ‚Ññ{appeal.appeal_id}</u></b>\n\n" \
                   f"–£–∫–∞–∑–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:\n" \
                   f"–ê–¥—Ä–µ—Å: <b>{address}</b>\n" \
                   f"–í–∏–¥ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ: <b>{appeal.animal}</b>\n" \
                   f"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∂–∏–≤–æ—Ç–Ω—ã—Ö: <b>{appeal.count_animal}</b>"

            if appeal.contact:
                text += f'\n–ö–æ–Ω—Ç–∞–∫—Ç—ã –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏: <b>{appeal.contact}</b>'
            text += f"\n\n–°—Ç–∞—Ç—É—Å: <b>{status.get(appeal.status)}</b>"
            if appeal.answer:
                text += f'\n–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: {appeal.answer}'
            return text, reply_markup
        else:
            text = '–í—ã –µ—â–µ –Ω–µ –æ—Å—Ç–∞–≤–ª—è–ª–∏ –æ–±—Ä–∞—â–µ–Ω–∏–π.'
            return text, None


async def text_input_address(telegram_id):
    address, = await db.get_user_data('users', telegram_id, ['address'])
    address = await geocoder(address)
    reply_markup = await next_button('next_input_animals')
    if address:
        text = f"–£–∫–∞–∑–∞–Ω–Ω—ã–π —Ä–∞–Ω–µ–µ –∞–¥—Ä–µ—Å: <b>{address}</b>\n\n" \
               f"–£–∫–∞–∂–∏—Ç–µ –≤ –ø–æ–ª–µ –¥–ª—è –≤–≤–æ–¥–∞ —Ç–æ—á–Ω—ã–π –∞–¥—Ä–µ—Å –∏–ª–∏ –æ—Å—Ç–∞–≤—å—Ç–µ –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é." \
               f"–ß—Ç–æ–±—ã –Ω–µ –≤–Ω–æ—Å–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è, –Ω–∞–∂–º–∏—Ç–µ <b><u><i>–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</i></u></b>.\n"
        return text, reply_markup
    else:
        text = f"–£–∫–∞–∂–∏—Ç–µ –≤ –ø–æ–ª–µ –¥–ª—è –≤–≤–æ–¥–∞ —Ç–æ—á–Ω—ã–π –∞–¥—Ä–µ—Å –∏–ª–∏ –æ—Å—Ç–∞–≤—å—Ç–µ –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é:"
        return text, None


async def text_input_animals(telegram_id):
    animal, = await db.get_user_data('users', telegram_id, ['animal'])
    reply_markup = await input_animals_buttons()
    if animal:
        text = f"–í—ã–±—Ä–∞–Ω–Ω—ã–π –≤–∞–º–∏ –≤–∞—Ä–∏–∞–Ω—Ç: <b>{animal}</b>\n\n" \
               f"–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã —É–∫–∞–∑–∞—Ç—å –¥—Ä—É–≥–æ–≥–æ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ, –≤–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å –∫–Ω–æ–ø–∫–∞–º–∏ –Ω–∏–∂–µ. " \
               f"–ï—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞ –Ω–µ—Ç –∏–ª–∏ –∏—Ö –Ω–µ—Å–∫–æ–ª—å–∫–æ, —Ç–æ <u>–≤–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å –ø–æ–ª–µ–º –¥–ª—è –≤–≤–æ–¥–∞</u>.\n\n" \
               f"ü¶â ‚Äì –°–æ–≤–æ–æ–±—Ä–∞–∑–Ω—ã–µ\n" \
               f"ü¶Ö ‚Äì –•–∏—â–Ω—ã–µ –ø—Ç–∏—Ü—ã\n" \
               f"üêç ‚Äì –ü—Ä–µ—Å–º—ã–∫–∞—é—â–∏–µ—Å—è\n" \
               f"üêí ‚Äì –ü—Ä–∏–º–∞—Ç—ã\n" \
               f"ü¶Å ‚Äì –ö—Ä—É–ø–Ω—ã–µ —Ö–∏—â–Ω–∏–∫–∏\n\n" \
               f"–ß—Ç–æ–±—ã –Ω–µ –≤–Ω–æ—Å–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è, –Ω–∞–∂–º–∏—Ç–µ <b><u><i>–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</i></u></b>.\n" \
               f"–ß—Ç–æ–±—ã –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ —à–∞–≥—É –≤–≤–æ–¥–∞ –∞–¥—Ä–µ—Å–∞, –Ω–∞–∂–º–∏—Ç–µ <b><u><i>–ù–∞–∑–∞–¥</i></u></b>"
        reply_markup.add(InlineKeyboardButton('–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å', callback_data='next_count_animals'))
        return text, reply_markup
    else:
        text = f"–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã —É–∫–∞–∑–∞—Ç—å –∂–∏–≤–æ—Ç–Ω–æ–≥–æ, –≤–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å –∫–Ω–æ–ø–∫–∞–º–∏ –Ω–∏–∂–µ. " \
               f"–ï—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞ –Ω–µ—Ç –∏–ª–∏ –∏—Ö –Ω–µ—Å–∫–æ–ª—å–∫–æ, —Ç–æ –≤–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å –ø–æ–ª–µ–º –¥–ª—è –≤–≤–æ–¥–∞.\n\n" \
               f"ü¶â ‚Äì –°–æ–≤–æ–æ–±—Ä–∞–∑–Ω—ã–µ\n" \
               f"ü¶Ö ‚Äì –•–∏—â–Ω—ã–µ –ø—Ç–∏—Ü—ã\n" \
               f"üêç ‚Äì –ü—Ä–µ—Å–º—ã–∫–∞—é—â–∏–µ—Å—è\n" \
               f"üêí ‚Äì –ü—Ä–∏–º–∞—Ç—ã\n" \
               f"ü¶Å ‚Äì –ö—Ä—É–ø–Ω—ã–µ —Ö–∏—â–Ω–∏–∫–∏\n\n" \
               f"–ß—Ç–æ–±—ã –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ —à–∞–≥—É –≤–≤–æ–¥–∞ –∞–¥—Ä–µ—Å–∞, –Ω–∞–∂–º–∏—Ç–µ <b><u><i>–ù–∞–∑–∞–¥</i></u></b>"
        return text, reply_markup


async def text_input_count_animals(telegram_id):
    count_animal, = await db.get_user_data('users', telegram_id, ['count_animal'])
    reply_markup = await back_button('back_input_animals')
    if count_animal:
        text = f"–£–∫–∞–∑–∞–Ω–Ω–æ–µ –≤–∞–º–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ: <b>{count_animal}</b>\n\n" \
               f"–£–∫–∞–∂–∏—Ç–µ –≤ –ø–æ–ª–µ –¥–ª—è –≤–≤–æ–¥–∞ –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∂–∏–≤–æ—Ç–Ω—ã—Ö, –∫–æ—Ç–æ—Ä–æ–µ –±—ã–ª–æ –∑–∞–º–µ—á–µ–Ω–æ.\n\n" \
               f"–ß—Ç–æ–±—ã –Ω–µ –≤–Ω–æ—Å–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è, –Ω–∞–∂–º–∏—Ç–µ <b><u><i>–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</i></u></b>.\n" \
               f"–ß—Ç–æ–±—ã –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ —à–∞–≥—É –≤–≤–æ–¥–∞ –∞–¥—Ä–µ—Å–∞, –Ω–∞–∂–º–∏—Ç–µ <b><u><i>–ù–∞–∑–∞–¥</i></u></b>"
        reply_markup.add(InlineKeyboardButton('–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å', callback_data='next_input_media'))
        return text, reply_markup
    else:
        text = f"–£–∫–∞–∂–∏—Ç–µ –≤ –ø–æ–ª–µ –¥–ª—è –≤–≤–æ–¥–∞ –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∂–∏–≤–æ—Ç–Ω—ã—Ö, –∫–æ—Ç–æ—Ä–æ–µ –±—ã–ª–æ –∑–∞–º–µ—á–µ–Ω–æ.\n\n" \
               f"–ß—Ç–æ–±—ã –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ —à–∞–≥—É –≤–≤–æ–¥–∞ –∞–¥—Ä–µ—Å–∞, –Ω–∞–∂–º–∏—Ç–µ <b><u><i>–ù–∞–∑–∞–¥</i></u></b>"
        return text, reply_markup


async def text_input_media(telegram_id):
    media, = await db.get_user_data('users', telegram_id, ['media'])
    reply_markup = await input_media_files_button()
    if media:
        print(await db.get_media_files(telegram_id))
        count_media = len((await db.get_media_files(telegram_id))[:5])

        text = f"–ó–∞–≥—Ä—É–∂–µ–Ω–æ —Ñ–æ—Ç–æ/–≤–∏–¥–µ–æ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤: <b>{count_media}</b>\n\n" \
               f"–í—ã –º–æ–∂–µ—Ç–µ —É–¥–∞–ª–∏—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ä–∞–Ω–µ–µ —Ñ–∞–π–ª—ã –∏ –∑–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤—ã–µ, –¥–ª—è —ç—Ç–æ–≥–æ " \
               f"–≤–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å –∫–Ω–æ–ø–∫–æ–π <b><u><i>–£–¥–∞–ª–∏—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã</i></u></b> –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å " \
               f"–∫ –∏–º–µ—é—â–∏–º—Å—è –Ω–æ–≤—ã–µ, –¥–ª—è —ç—Ç–æ–≥–æ –ø—Ä–æ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ —Ñ–∞–π–ª—ã, –Ω–æ –ø–æ–º–Ω–∏—Ç–µ, —á—Ç–æ –∏—Ö –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ " \
               f"–Ω–µ –¥–æ–ª–∂–Ω–æ –ø—Ä–µ–≤—ã—à–∞—Ç—å 5-—Ç–∏.\n\n" \
               f"–ï—Å–ª–∏ –Ω–µ —Ö–æ—Ç–∏—Ç–µ –≤–Ω–æ—Å–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–π, —Ç–æ –Ω–∞–∂–º–∏—Ç–µ <b><u><i>–ù–∞–∑–∞–¥</i></u></b> –∏–ª–∏ " \
               f"<b><u><i>–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</i></u></b>"

        reply_markup.add(InlineKeyboardButton('–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å', callback_data='next_send_menu'))
        reply_markup.add(InlineKeyboardButton('–£–¥–∞–ª–∏—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã', callback_data='delete_files'))
    else:
        text = "–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ/–≤–∏–¥–µ–æ –º–∞—Ç–µ—Ä–∏–∞–ª—ã, –Ω–µ –±–æ–ª–µ–µ 5-—Ç–∏.\n\n" \
               "–ï—Å–ª–∏ –≤—ã —É–∂–µ —É—à–ª–∏, –∏–ª–∏ —É –≤–∞—Å –Ω–µ—Ç —Ñ–æ—Ç–æ/–≤–∏–¥–µ–æ, –≤–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å –∫–Ω–æ–ø–∫–æ–π <b><u><i>–ù–µ—Ç —Ñ–æ—Ç–æ</i></u></b>. " \
               "–ü–æ–º–Ω–∏—Ç–µ, —á—Ç–æ —É –æ–±—Ä–∞—â–µ–Ω–∏–π –±–µ–∑ —Ñ–æ—Ç–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ø–æ–Ω–∏–∂–∞–µ—Ç—Å—è.\n\n" \
               "–ß—Ç–æ–±—ã –≤–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞–∑–∞–¥, –≤–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å –∫–Ω–æ–ø–∫–æ–π –Ω–∏–∂–µ."
    return text, reply_markup


async def text_menu(telegram_id, contact_input=None):
    address, animal, count_animal, media, contact, appeal_id = \
        await db.get_user_data('users', telegram_id, ['address', 'animal', 'count_animal',
                                                      'media', 'contact', 'appeal_id'])
    address = await geocoder(address)
    text = f"<b>–ù–æ–º–µ—Ä –≤–∞—à–µ–≥–æ –æ–±—Ä–∞—â–µ–Ω–∏—è ‚Ññ{appeal_id}</b>\n\n" \
           f"–£–∫–∞–∑–∞–Ω–Ω—ã–µ –≤–∞–º–∏ –¥–∞–Ω–Ω—ã–µ —Ä–∞–Ω–µ–µ:\n" \
           f"–ê–¥—Ä–µ—Å: <b>{address}</b>\n" \
           f"–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∂–∏–≤–æ—Ç–Ω—ã—Ö: <b>{count_animal}</b>"
    if media:
        count_media = await db.get_count_media_files(appeal_id)
        if count_media > 5:
            count_media = 5
        text += f'\n–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö —Ñ–æ—Ç–æ/–≤–∏–¥–µ–æ —Ñ–∞–π–ª–æ–≤: <b>{count_media}</b>'
    if animal:
        text += f'\n–í–∏–¥ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ: <b>{animal}</b>'
    if contact_input:
        contact = contact_input
    if contact:
        text += f'\n–ö–æ–Ω—Ç–∞–∫—Ç—ã –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏: <b>{contact}</b>'

    text += f"\n\n–í—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç–µ –≤–Ω–µ—Å—Ç–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ –¥–∞–Ω–Ω–æ–º—É –æ–±—Ä–∞—â–µ–Ω–∏—é, –Ω–∞–ø—Ä–∏–º–µ—Ä, " \
            f"—Å–≤–æ–∏ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –º—ã " \
            f"–º–æ–≥–ª–∏ —Å–≤—è–∑–∞—Ç—å—Å—è —Å –≤–∞–º–∏ –∏ –¥–∞—Ç—å –ø–æ–ª–Ω—É—é –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å. –î–ª—è —ç—Ç–æ–≥–æ –≤–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π –Ω–∏–∂–µ.\n\n" \
            f"–ï—Å–ª–∏ –±—ã–ª–∞ –≤–Ω–µ—Å–µ–Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, —Ç–æ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É <b><u><i>–û—Ç–ø—Ä–∞–≤–∏—Ç—å</i></u></b>\n\n" \
            f"–ß—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ, –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å—Ç–∞—Ç—É—Å –æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö –∑–∞—è–≤–æ–∫ –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ –ø–æ–ª—É—á–∏—Ç—å " \
            f"–ø–æ–º–æ—â—å –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –±–æ—Ç–∞, –≤–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π –Ω–∏–∂–µ."

    reply_markup = await menu_buttons()
    return text, reply_markup


async def text_for_send_data(telegram_id, media_input=False):
    address, animal, count_animal, media = \
        await db.get_user_data('users', telegram_id, ['address', 'animal', 'count_animal', 'media'])
    address = await geocoder(address)
    if media_input:
        media = media_input
    text = '<b><u>–£–∫–∞–∑–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:</u></b>\n\n' \
           f'–ê–¥—Ä–µ—Å: <b>{address}</b>\n' \
           f'–í–∏–¥ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ: <b>{animal}</b>\n' \
           f'–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∂–∏–≤–æ—Ç–Ω—ã—Ö: <b>{count_animal}</b>'
    if media:
        count_media = len(await db.get_media_files(telegram_id))
        if count_media > 5:
            text += f"\n–ó–∞–≥—Ä—É–∂–µ–Ω—ã –Ω–µ –≤—Å–µ —Ñ–∞–π–ª—ã, –ø–æ—Å–∫–æ–ª—å–∫—É –ø—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –≤ 5 —Ñ–∞–π–ª–æ–≤"
            count_media = 5
        text += f'\n–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö —Ñ–æ—Ç–æ/–≤–∏–¥–µ–æ —Ñ–∞–π–ª–æ–≤: <b>{count_media}</b>'

    text += f"\n\n–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –≤–Ω–µ—Å—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –≤–µ–¥–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ " \
            f"–≤–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å –∫–Ω–æ–ø–∫–æ–π <b><u><i>–ù–∞–∑–∞–¥</i></u></b>\n" \
            f"–ï—Å–ª–∏ –≤—Å–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, —Ç–æ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –ø–µ—Ä–≤–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∫–Ω–æ–ø–∫–æ–π <b><u><i>–û—Ç–ø—Ä–∞–≤–∏—Ç—å</i></u></b>"

    reply_markup = await send_button()

    return text, reply_markup


async def text_input_contact(telegram_id):
    contact, = await db.get_user_data('users', telegram_id, ['contact'])
    if contact:
        text = f"–£–∫–∞–∑–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏: <b>{contact}</b>\n\n" \
               f"–ß—Ç–æ–±—ã –æ–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å —Å—Ç—Ä–æ–∫–æ–π –≤–≤–æ–¥–∞.\n\n" \
               f"–ï—Å–ª–∏ –Ω–µ —Ö–æ—Ç–∏—Ç–µ –≤–Ω–æ—Å–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è, —Ç–æ –Ω–∞–∂–º–∏—Ç–µ <b><u><i>–ù–∞–∑–∞–¥</i></u></b>"
    else:
        text = f"–£–∫–∞–∂–∏—Ç–µ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ (email –∏–ª–∏ telegram).\n\n" \
               f"–ï—Å–ª–∏ –Ω–µ —Ö–æ—Ç–∏—Ç–µ –Ω–∏—á–µ–≥–æ —É–∫–∞–∑—ã–≤–∞—Ç—å, –Ω–∞–∂–º–∏—Ç–µ <b><u><i>–ù–∞–∑–∞–¥</i></u></b>"
    reply_markup = await back_button('back_to_menu')
    return text, reply_markup
